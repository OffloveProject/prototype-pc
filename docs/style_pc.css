html,body{margin:0;padding:0;font-family:system-ui,-apple-system,"Hiragino Sans","Noto Sans JP",sans-serif;background:#111;color:#f3f3f3;
overflow-x: clip; /*⇤ --- horizontal flicker fix（グローバルで横のはみ出しを無視） --- */
width: 100%;
height: 100%;
}

/* オートスケール用コンテナ */
#game-container {
  width: 1920px;
  height: 1080px;
  position: relative;
  transform-origin: 0 0;
  margin: 0;
}
.app{max-width:1920px;width:100%;margin:0 auto;min-height:100vh;display:flex;flex-direction:column;position: relative;}
header{padding:16px 16px 0;text-align:center;font-weight:700;letter-spacing:.04em}
main{flex:1;display:flex;flex-direction:column;padding:40px 60px;gap:20px;width:100%;max-width:1920px;margin:0 auto;}
.btn{appearance:none;border:none;padding:14px 20px;border-radius:12px;font-size:18px;font-weight:700;background:#2a2a2a;color:#fff;width:100%;cursor:pointer;transition:all 0.2s ease;}
.btn[disabled]{opacity:.4}
.btn-ghost{background:transparent;border:1px solid #2c2c2c}

/* グローバルで横のはみ出しを無視（flicker抑止） ↓↓↓ここから*/
/* --- horizontal flicker fix --- */
@supports not (overflow-x: clip) { html, body { overflow-x: hidden; } }
/* グローバルで横のはみ出しを無視（flicker抑止） ↑↑↑ここまで*/

/* モーダル中はゲーム画面のタッチを受けない（保険）↓↓↓ここから */
body.modal-open #page-scene .scene {
  pointer-events: none;
}
/* ただしモーダル自体は操作できるようにする */
body.modal-open .modal,
body.modal-open .modal * {
  pointer-events: auto;
}
/* モーダル中はゲーム画面のタッチを受けない（保険）↑↑↑ここまで */

:root{
  --app-max: 1920px;      /*PC向け：1920x1080 */
  --phone-ratio: 16 / 9;   /* PC向け：横長アスペクト比 */
  --title-inner: 1200px;           /* PC向け：タイトル画面の最大幅 */
  --pink:#F09199;           /* メインピンク */
  --pink2:#FFD6E0;          /* サブピンク */
  --sky:#C8E4FF;            /* 淡い水色 */
}

/* ===== Offstage Love 共通スクロールバー =====↓↓↓ここから ※動作しないので要確認 */

/* 色だけ変えるFirefox用（細いピンク系バー） */
/* ===== Firefox 専用 ===== */
@supports not selector(::-webkit-scrollbar) {
  .app * {
    scrollbar-width: thin;
    scrollbar-color: rgba(240,145,153,0.9) rgba(8,8,16,0.9);
  }
}

/* ===== Chrome / Edge / Safari 共通 ===== */
*::-webkit-scrollbar {
  width: 8px;
}

*::-webkit-scrollbar-track {
  background:
    radial-gradient(circle at 30% 0%, rgba(255,255,255,0.18) 0, transparent 40%),
    radial-gradient(circle at 70% 100%, rgba(200,228,255,0.25) 0, transparent 55%),
    #05050b;
  border-radius: 999px;
}

*::-webkit-scrollbar-thumb {
  background: linear-gradient(135deg, #F7A7B0 0%, #F09199 35%, #C8E4FF 100%);
  border-radius: 999px;
  box-shadow:
    0 0 0 1px rgba(255,255,255,0.35),
    0 0 8px rgba(240,145,153,0.65),
    0 0 14px rgba(200,228,255,0.55);
}

/* ===== Offstage Love 共通スクロールバー =====↑↑↑ここまで */


/* 立ち絵画像が未設定 or src="" のときは完全に非表示 （スマホのブラウザ用） */
#char-img:not([src]),
#char-img[src=""] {
  display: none;
}

/* ===== Tap Effect ===== ↓↓↓ここから*/
.tap-effect {
  position: absolute;
  pointer-events: none;
  font-size: 18px;
  opacity: 0;
  transform: scale(0.6);
  animation: tap-pop 1.2s ease-out forwards;
  text-shadow: 0 0 6px rgba(255,255,255,0.6);
  z-index: 9999;   /* ← 全エフェクトよりも最前面へ */
}

@keyframes tap-pop {
  0%   { opacity: 1; transform: scale(0.6) translate(0, 0); }
  70%  { opacity: 0.9; transform: scale(1.2) translate(var(--dx), var(--dy)); }
  100% { opacity: 0; transform: scale(1.6) translate(calc(var(--dx) * 1.5), calc(var(--dy) * 1.5)); }
}
/* ===== Tap Effect ===== ↑↑↑ここまで*/

/*タイトル画面のレイアウト調整↓↓↓ここから*/
/* PC向け：このクラスを付けた要素は横幅を統一 */
.title-line{
  width: min(90%, var(--title-inner));
  max-width: 1200px;
  margin-inline: auto;
}
/* 「.row」に入っている単体ボタン（Albumなど）も100%に */
.title-line.row .btn{
  width: 100%;
}
/* 4アイコン行はグリッドで幅を揃える */
.icon-row{
  display: grid !important;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
}
.icon-row .btn{
  width: 100%;      /* 行のセルいっぱいに */
}

/* Quick Actions（3ボタン行）も同じ幅に揃う（コンテナに .title-line を付けるだけ） */
/*タイトル画面のレイアウト調整↑↑↑ここまで*/

/* 追加：スマホ画面の枠（ここに中身を全部入れる）↓↓↓ここから */
.phone-viewport{
  position: relative;
  width: 100%;
  max-width: var(--app-max);
  aspect-ratio: var(--phone-ratio);
  /* ← はみ出しで消えていたので縦スクロールを許可 */
  overflow-y: auto;
  overflow-x: clip;
  /*overflow-x: hidden;⇤横スクロールバー出現防止のため"overflow-x: clip;"に変更*/ 
  -webkit-overflow-scrolling: touch;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  justify-content: flex-start;
  margin: 0 auto;
  padding: 16px 12px calc(16px + env(safe-area-inset-bottom));
  padding-bottom: max(12px, env(safe-area-inset-bottom)); /* iOS のホームバーかぶりを避けるためのパディング追加処理（任意）*/
}



/* 既存のタイトル背景は“枠いっぱい”に合わせる */
.title-bg{
  position: absolute; inset: 0;
  background: #000 center/cover no-repeat;
  transition: opacity .35s ease;
  height: 100%;                /* ← ここを 100% に。clamp を外す */
}
/* 追加：スマホ画面の枠（ここに中身を全部入れる）↑↑↑ここまで */

/* ==== Splash (catch copy) ====↓↓↓ここから */
.splash {
  position: absolute;
  inset: 0;
  z-index: 2000;
  display: grid;
  place-items: center;
  background: #0a0a12; /* 完全に真っ暗ではなく紺に近い色 */
  transition: opacity 1s ease;
}
.splash.hidden { display:none !important; }
.splash.fadeout { opacity: 0; }

.splash-inner {
  font-family: ui-serif, "Hiragino Mincho ProN", "Noto Serif JP", serif;
  font-size: 24px;
  font-weight: 700;
  color: #fff;
  letter-spacing: .2em;
  text-shadow: 0 0 12px rgba(240,145,153,.7);
  animation: splash-pop 2.2s ease forwards;
}
@keyframes splash-pop {
  0% { opacity: 0; transform: scale(0.95); }
  20%{ opacity: 1; transform: scale(1); }
  80%{ opacity: 1; transform: scale(1); }
  100%{ opacity: 0; transform: scale(1.05); }
}
/* ==== Splash (catch copy) ====↑↑↑ここまで */

/* ==== Start Screen ====↓↓↓ここから */
  .start-screen{
/* PC向け：全画面表示 */
  /*width: 100%;
  max-width: 1920px; ← ※PC用※ これをコメントアウトして、position: fixed; inset: 0; に変更 */
  margin: 0 auto;
  position: absolute; inset: 0; z-index: 1000;
  display: grid; place-items: center;
  overflow: hidden;
  transition: opacity .3s ease;
  background: linear-gradient(180deg, #0a0a12 0%, #121222 50%, #0a0a12 100%);
}
.start-screen.bye{ opacity: 0; }
.start-screen.hidden{ display:none !important; }

/* ==== Falling Music Notes ====↓↓↓ここから */
.start-screen .notes{
  position:absolute; inset:0;
  pointer-events:none; 
    z-index: 15; /* ← 星やオーロラ(10以下)より前、文字(20以上)より後 */
  }

.start-screen .notes span{
  position:absolute;
  top:-10%;               /* 上端の外から出現 */
  transform: translateY(0) translateX(0) rotate(0deg);
  opacity:.9; 
  will-change: top, margin-left, transform;  /* 3本に分離：落下=top / 横揺れ=margin-left / 回転=transform */
  color: #F09199;  /* ← これを追加（例: 白） */
  /* もし淡いピンク系にしたいなら #fcd, #fcc など */
  /* 各spanごとにJSで --dur / --delay / --x を設定します */
    animation:
    note-fall var(--dur,10s) linear var(--delay,0s) infinite,
    note-swayX 3.6s ease-in-out calc(var(--delay,0s)*.5) infinite alternate,
    note-rot  var(--dur,10s) linear var(--delay,0s) infinite;
  text-shadow: 0 0 6px rgba(0,0,0,.35); /* 薄い縁取りで視認性↑（軽い） */
}

/* 落下：縦だけ＋回転（transformはここだけで使う） */
@keyframes note-fall{
  0%   { top:-10%;  opacity:0; }
  5%   { opacity:.9; }
  100% { top:110%; }
}
/* 横揺れは margin-left で（transformと衝突しない） */
@keyframes note-swayX{
  0%   { margin-left:-8px; }
  100% { margin-left: 8px; }
}

/* 低負荷モード（ユーザーがアニメ軽減を選んでいる場合は停止） */
@media (prefers-reduced-motion: reduce){
  .start-screen .notes span{ animation:none; }
}
/* ==== Falling Music Notes ====↑↑↑ここまで */

/* 星空とオーロラ（画像なし） */
.start-screen .sky     { position:absolute; inset:0; z-index:5; pointer-events:none; }
.start-screen .stars,
.start-screen .twinkle{
  position:absolute; inset:-20% -20%;
  background-image:
    radial-gradient(rgba(255,255,255,.85) 1.2px, transparent 1.4px);
  background-size: 7px 7px;   /* ← 密度を下げる */
  filter: blur(.4px);
}
.start-screen .twinkle{
  animation: twinkle 4s ease-in-out infinite alternate;
  opacity:.7;
}
@keyframes twinkle{
  0%{ opacity:.35; transform: translate3d(0,0,0) scale(1); }
  100%{ opacity:.9; transform: translate3d(-2%,1%,0) scale(1.02); }
}

/* オーロラ/星雲の光 */
.start-screen .aurora{
  position:absolute; inset:0;
  background:
    radial-gradient(600px 260px at 20% 120%, rgba(240,145,153,.28), transparent 60%),
    radial-gradient(500px 220px at 80% 110%, rgba(120,170,255,.22), transparent 60%),
    conic-gradient(from 210deg at 50% 120%, rgba(255,180,220,.12), transparent 30%, rgba(150,190,255,.12), transparent 70%);
  filter: blur(26px) saturate(1.2);
  mix-blend-mode: screen;
  animation: aurora 8s ease-in-out infinite alternate;
}
@keyframes aurora{
  0%{ transform: translateY(0) }
  100%{ transform: translateY(-2%) }
}

/*♡枠↓↓↓ここから*/
/* ==== Romantic Title (スタート画面用) ==== */
.romantic-title, 
.start-inner {
  position: relative;
  z-index: 20; /* ← タイトルやTap to Startは必ず音符より上 */
}

.romantic-title {
  position: relative;
  display: inline-block;
  padding: 1rem 1.2rem;
  margin: 0 auto;
  border-radius: 16px;
  background: rgba(255, 200, 220, 0.01);   /* 透過度アップ */
  border: 1px solid rgba(255, 180, 200, 0.15); /* 薄め */
  box-shadow: 0 0 18px rgba(255, 150, 200, 0.18); /* 光も控えめ */
  backdrop-filter: blur(6px);
  animation: floatFade 2s ease-in-out both;
}

.romantic-title::before {
  content: "❤";
  position: absolute;
  top: -1.2rem;
  left: -1.2rem;
  font-size: 1.8rem;
  color: rgba(255, 170, 210, 0.4);
  animation: heartWiggle 2.5s infinite ease-in-out;
}
.romantic-title::after {
  content: "♡";
  position: absolute;
  bottom: -1rem;
  right: -1rem;
  font-size: 1.7rem;
  color: rgba(255, 200, 230, 0.4);
  animation: heartWiggleAlt 3s infinite ease-in-out;
}

@keyframes heartWiggle {
  0%, 100% { transform: rotate(-15deg) translateX(0); }
  50% { transform: rotate(-10deg) translateX(3px); }
}
@keyframes heartWiggleAlt {
  0%, 100% { transform: rotate(12deg) translateY(0); }
  50% { transform: rotate(16deg) translateY(2px); }
}
@keyframes floatFade {
  from { opacity: 0; transform: translateY(8px); }
  to   { opacity: 1; transform: translateY(0); }
}
/*♡枠↑↑↑ここまで*/

/* ===== Romantic Buttons =====↓↓↓ここから */

/* “かわいい版”を付与するだけで見た目を切替 */
.btn-romance{
  position: relative;
  border: 2px solid transparent;
  border-radius: 16px;
  padding: 12px 16px;
  font-weight: 800;
  letter-spacing: .02em;
  color: #fff;
  contain: paint; 
  isolation: isolate;

  /* 中身(黒グラデ) と 外側(発光グラデ境界) を二重背景で表現 */
  background:
    linear-gradient(180deg, #2b2b2e 0%, #1a1a1d 100%) padding-box,
    linear-gradient(120deg, rgba(240,145,153,.95), rgba(255,255,255,.35) 40%, rgba(200,228,255,.85)) border-box;
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.09),
    inset 0 -10px 24px rgba(0,0,0,.35),
    0 6px 16px rgba(0,0,0,.35),
    0 0 10px rgba(240,145,153,.35);

  transition: transform .08s ease, filter .2s ease, box-shadow .2s ease, background .35s ease;
}

/* ふわっと光が横切る */
.btn-romance::before{
  content:"";
  position:absolute; inset:-2px;
  border-radius: inherit;
  background: linear-gradient(105deg, transparent 0%, rgba(255,255,255,.18) 35%, transparent 70%);
  opacity:.0;
  transform: translateX(-30%);
  pointer-events:none;
  transition: opacity .25s ease, transform .6s ease;
  inset:-1px;
}

/* 星のきらめき（控えめ） */
.btn-romance::after{
  content:"✨";
  position:absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%) scale(.9) rotate(-8deg);
  font-size: 14px;
  opacity:.0;
  transition: opacity .2s ease, transform .2s ease;
}

/* Hover / Active */
.btn-romance:hover{
  filter: brightness(1.06);
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.10),
    inset 0 -10px 24px rgba(0,0,0,.32),
    0 10px 22px rgba(0,0,0,.38),
    0 0 16px rgba(240,145,153,.65),
    0 0 30px rgba(200,228,255,.45);
}
.btn-romance:hover::before{ opacity:.9; transform: translateX(15%); }
.btn-romance:hover::after { opacity:.9; transform: translateY(-50%) scale(1); }

.btn-romance:active{
  transform: translateY(1px);
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.06),
    inset 0 -8px 20px rgba(0,0,0,.38),
    0 6px 14px rgba(0,0,0,.4),
    0 0 12px rgba(240,145,153,.55);
}

/* タイトル面など横長ボタンの視認性を微調整 */
.title-line .btn-romance{ font-size:16px; }

/* 選択肢（.choice の中の .btn）は密度が上がるので少しだけコンパクトに */
.choice .btn.btn-romance{ padding: 10px 14px; border-radius: 14px; }

/* ライトテーマでもかわいさ維持（必要なら） */
.theme-light .btn-romance{
  background:
    linear-gradient(180deg, #ececec 0%, #dcdcdc 100%) padding-box,
    linear-gradient(120deg, rgba(240,145,153,.9), rgba(255,255,255,.6) 40%, rgba(200,228,255,.9)) border-box;
  color:#222;
}
/* ===== Romantic Buttons =====↑↑↑ここまで */


/* 中央のタイポグラフィ */
.start-inner{ 
  position:relative; text-align:center; padding:24px 16px; 
}
.start-title {
  font-family: "Hiragino Mincho ProN", "Noto Serif JP", serif;
  font-weight: 700;
  font-size: clamp(32px, 8vw, 36px);
  letter-spacing: .08em;
  color: #fff;

  /* 光彩と縁取り */
  text-shadow:
    0 0 6px rgba(240,145,153,0.6),
    0 0 14px rgba(240,145,153,0.4),
    1px 1px 2px rgba(0,0,0,0.6);
}

/* サブタイトルをリボン風に */
.start-sub {
  margin-top: 6px;
  font-size: 13px;
  letter-spacing: .3em;
  color: #ffeef4;
  position: relative;
  display: inline-block;
  padding: 2px 10px;
  background: rgba(240,145,153,0.15);
  border-radius: 12px;
  text-shadow: 0 0 4px rgba(0,0,0,0.5);
}
.start-sub{
  margin-top: 2px; opacity:.85; letter-spacing:.2em;
  font-size: 12px;
}
.start-tag{
  margin-top: 10px; font-size: 13px; opacity:.9;
}

/* サブタイトルの前後に飾り線 */
.start-sub::before,
.start-sub::after {
  content: "";
  position: absolute;
  top: 50%;
  width: 18px;
  height: 1px;
  background: rgba(255, 200, 210, 0.8);
}
.start-sub::before { left: -22px; }
.start-sub::after { right: -22px; }

/* Tap to Start */
.start-inner .tap{
  margin-top: 16px;
  font-size: 15px;
  font-weight: 700;
  padding: 12px 22px;
  border-radius: 12px;
  background: rgba(0,0,0,0.5);
  color: #fff;
  border: 2px solid #F09199;
  box-shadow: 
    0 0 10px rgba(240,145,153,.5),
    0 0 18px rgba(240,145,153,.4);
  animation: breathe 1.8s ease-in-out infinite;
}
@keyframes breathe{ 0%{transform:scale(1)}50%{transform:scale(1.03)}100%{transform:scale(1)} }

/* サブタイトルやタグの文字も少し明るく */
.start-sub, .start-tag, .start-inner span {
  color: #eee;
  text-shadow: 0 0 6px rgba(0,0,0,0.6);
}
.start-inner .hint{
  margin-top: 8px;
  font-size:11px;
  opacity:.85;               /* 少し明るく */
  padding: 2px 6px;          /* 背景用の余白 */
  background: rgba(32, 26, 26, 0.7); /* 薄いグレー、透過 */
  border-radius: 6px;        /* 角丸 */
  display: inline-block;     /* 背景が文字の周囲だけに付く */
}

/* ==== Start Screen ====↑↑↑ここまで */

/* タイトル画面のロゴ↓↓↓ここから */
/* PC向け：ロゴ画像のスタイル */
.logo-img {
  max-width: 400px;  /* PC向け：大きく表示 */
  height: auto;
  margin: 0 auto 0 auto;
  display: block;
}
.title-card {
  margin-top: 8px; 
  background: transparent;  /* 背景カードを消して画像を活かす */
  border: none;
  box-shadow: none;
}
.logo-glow {
  position: absolute;
  top: 40px; left: 50%;
  width: 300px; height: 300px;
  transform: translateX(-50%);
  background: radial-gradient(circle, rgba(240,145,153,0.5) 0%, transparent 70%);
  filter: blur(60px);
  z-index: 0;
}
.logo-ribbon {
  width: 80%;
  height: 4px;
  margin: 10px auto 0 auto;
  background: linear-gradient(90deg, transparent, #F09199, transparent);
  border-radius: 4px;
}

/* タイトル画面のロゴ↑↑↑ここまで */

/* タイトル画面のContinueボタン　グレーアウト↓↓↓ここから */
/* Continue の非アクティブ見た目 */
#btn-continue.disabled,
#btn-continue:disabled {
  opacity: .4;
  cursor: not-allowed;
  filter: grayscale(70%);
  background: rgba(255,255,255,.08);
  border-color: rgba(255,255,255,.1);
  text-shadow: none;
  transition: none;
}
#btn-continue.disabled:hover,
#btn-continue:disabled:hover {
  transform: none;
  box-shadow: none;
}

/* ======================================
   ボタンの無効化（disabled / .disabled）※別バージョン　覚書

.btn:disabled,
.btn.disabled {
  opacity: 0.45;                    /* ← 少し濃く 
  background: rgba(90, 90, 90, 0.4); /* ← 背景もやや濃いグレーに 
  color: #ccc;                      /* ← 文字も淡い白系で読みやすく 
  pointer-events: none;
  box-shadow: none;                 /* ← 立体感を消す 
  text-shadow: 0 0 4px rgba(255,255,255,0.1);
  transition: all 0.3s ease;
}

/* Hover時のフェード無効化（安全措置） 
.btn:disabled:hover,
.btn.disabled:hover {
  background: rgba(90, 90, 90, 0.4);
  color: #ccc;
}
   ====================================== */
/* タイトル画面のContinueボタン　グレーアウト↑↑↑ここまで */


/* PC向け：タイトル画面のアイコンボタン（Settings / About / Musics / NFT）↓↓↓ここから */
.title-btn-ghost{
  width: 120px;
  height: 120px;
  border-radius: 16px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  font-weight: 600;

  /* 背景を半透明にして背景画像と分離 */
  background: rgba(255, 255, 255, 0.15);
  border: 1px solid rgba(255, 255, 255, 0.3);
  backdrop-filter: blur(6px);   /* ガラス風（対応ブラウザのみ） */

  color: #fff;                  /* 白文字で視認性UP */
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
  transition: all 0.2s ease;
}

.title-btn-ghost:hover {
  background: rgba(255, 192, 203, 0.25); /* ホバー時は淡いピンク強調 */
  border-color: #F09199;                 /* プロジェクトカラーにリンク */
  box-shadow: 0 6px 14px rgba(0,0,0,0.35);
}

.title-btn-ghost span {
  font-size: 14px;
  margin-top: 6px;
}


/* Musicsデザイン用↓↓↓ここから */
/* ===== Musics modal ===== */

/*波紋アニメ ↓↓↓ここから*/

.track-row {
  position: relative;
  display: flex;
  align-items: center;
  padding: 10px 12px;
  border-radius: 14px;
  background: rgba(10,10,18,0.7);
  margin-bottom: 8px;
  border: 1px solid rgba(255,255,255,0.06);
  cursor: pointer;
}

.track-number {
  width: 20px;
  text-align: right;
  font-size: 12px;
  margin-right: 10px;
  opacity: 0.65;
}

.track-wave {
  width: 16px;
  height: 16px;
  background: radial-gradient(circle, #ffbde3 0%, transparent 70%);
  border-radius: 50%;
  opacity: 0;
  transform: scale(0.6);
  transition: 0.25s;
}

.track-wave.show {
  opacity: 1;
  animation: wave-pulse 1.2s infinite ease-in-out;
}



.track-row.is-active .track-wave {
  animation: wave 1.8s ease-out infinite;
}

.track-wave.pulsing {
  animation: wave-pulse 1.2s infinite ease-in-out;
}


@keyframes wave { /*拡がる波紋*/
  0%   { transform: translateY(-50%) scale(0.8); opacity: 0.65; background: rgba(255,200,215,0.45); }
  70%  { transform: translateY(-50%) scale(2.0); opacity: 0; }
  100% { transform: translateY(-50%) scale(2.4); opacity: 0; }
}
@keyframes wave-pulse { /*再生中の鼓動アニメ*/
  0%   { transform: scale(0.6); opacity: 0.8; }
  50%  { transform: scale(1.1); opacity: 0.4; }
  100% { transform: scale(0.6); opacity: 0.8; }
}

/*波紋アニメ ↑↑↑ここまで*/

/* ==== Musics：現在再生中エリア ====↓↓↓ここから */


.tracks-player {
  margin: 8px 0 14px;
  padding: 12px 12px 14px;
  border-radius: 16px;
  background: rgba(16, 14, 26, 0.78);          /* 夜空っぽい濃紺 */
  border: 1px solid rgba(255, 255, 255, 0.06);
  backdrop-filter: blur(14px);
}

.tracks-player-text {
  margin-bottom: 6px;
}

.np-title {
  font-size: 14px;
  font-weight: 700;
  line-height: 1.3;
}

.np-artist {
  font-size: 11px;
  opacity: 0.75;
}

/* 再生位置バー周り */

.tracks-player-seek {
  display: flex;
  align-items: center;
  gap: 6px;
  margin: 6px 0 10px;
}

.np-time {
  font-size: 10px;
  opacity: 0.7;
  min-width: 32px;
  text-align: center;
}

#np-seek {
  flex: 1;
  appearance: none;
  height: 4px;
  border-radius: 999px;
  background: rgba(255, 255, 255, 0.15);
  outline: none;
}

/* スライダーつまみ（再生位置） */
#np-seek::-webkit-slider-thumb {
  appearance: none;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: #f6d0d4;
  box-shadow: 0 0 0 2px rgba(0,0,0,0.4);
}
#np-seek::-moz-range-thumb {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: #f6d0d4;
  box-shadow: 0 0 0 2px rgba(0,0,0,0.4);
}

/* 共通: range のトラック基本スタイル（ベース色だけ）↓↓↓ここから */
#np-seek,
#np-volume {
  appearance: none;
  height: 4px;
  border-radius: 999px;
  background: rgba(255, 255, 255, 0.18); /* JS で上書きされるベース */
  outline: none;
}
/* 既存の thumb 設定はそのまま流用 */

#np-seek::-webkit-slider-runnable-track,
#np-volume::-webkit-slider-runnable-track {
  background: linear-gradient(
      90deg,
      var(--pink) var(--seek-fill),
      rgba(255,255,255,0.18) var(--seek-fill)
  );
}

#np-seek,
#np-volume {
  --seek-fill: 0%;
}
/* 共通: range のトラック基本スタイル（ベース色だけ）↑↑↑ここまで */

/* コントロールボタン＋音量 */

.tracks-player-controls {
  display: flex;
  align-items: center;
  gap: 10px;
}

.np-btn {
  width: 32px;
  height: 32px;
  border-radius: 999px;
  border: none;
  padding: 0;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  cursor: pointer;
  background: rgba(255, 255, 255, 0.12);
  color: #ffffff;
  box-shadow: 0 2px 6px rgba(0,0,0,0.5);
}
/* ホバー（PC用） */
.np-btn:hover {
  filter: brightness(1.08);
}

.np-btn-main {
  width: 56px;
  height: 56px;
  border-radius: 999px;
  font-size: 26px;
  color: #988f8f;
  background:
    radial-gradient(circle at 30% 0%, #ffffff 0, rgba(255,255,255,0) 50%),
    linear-gradient(135deg, #f09191, #f6b7b5);
  box-shadow:
    0 0 0 1px rgba(255,255,255,0.3),
    0 8px 18px rgba(0,0,0,0.6);
}

.np-btn-main:hover {
  transform: translateY(-1px) scale(1.02);
  box-shadow:
    0 0 0 1px rgba(255,255,255,0.4),
    0 10px 22px rgba(0,0,0,0.7);
}
.np-btn-main:active {
  transform: translateY(1px) scale(0.97);
  box-shadow:
    0 0 0 1px rgba(255,255,255,0.2),
    0 4px 12px rgba(0,0,0,0.6);
}

/* 音量スライダー */

.np-volume {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-left: auto;
  flex: 1;
}

.np-vol-icon {
  font-size: 14px;
  opacity: 0.8;
}

#np-volume {
  flex: 1;
  appearance: none;
  height: 4px;
  border-radius: 999px;
  background: rgba(255, 255, 255, 0.18);
  outline: none;
}

#np-volume::-webkit-slider-thumb {
  appearance: none;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: #ffffff;
}
#np-volume::-moz-range-thumb {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: #ffffff;
}

/* ==== Musics：現在再生中エリア ====↑↑↑ここまで */
.tracks-card {
  padding: 16px 16px 20px;
  backdrop-filter: blur(16px);
}

.tracks-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin: 4px 0 12px;
}

.tracks-cover {
  width: 56px;
  height: 56px;
  border-radius: 18px;
  background:
    radial-gradient(circle at 20% 0%, #fff 0, rgba(255,255,255,0) 55%),
    radial-gradient(circle at 80% 100%, #f09199 0, rgba(240,145,153,0) 60%),
    linear-gradient(135deg, #151820, #2a2335);
  box-shadow: 0 8px 20px rgba(0,0,0,0.45);
  position: relative;
}
.tracks-cover::after {
  content: "OL";
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 18px;
  letter-spacing: 0.08em;
  color: rgba(255,255,255,0.88);
}

.tracks-meta {
  flex: 1;
  min-width: 0;
}
.tracks-title-main {
  font-size: 14px;
  font-weight: 700;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.tracks-sub {
  font-size: 11px;
  opacity: 0.72;
  margin-top: 2px;
}

.tracks-main-controls {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 10px;
}

.trk-main-btn {
  flex: 0 0 56px;
  height: 56px;
  border-radius: 999px;
  border: none;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 26px;
  line-height: 1;
  color: #fff;
  background:
    radial-gradient(circle at 30% 0%, #fff 0, rgba(255,255,255,0) 50%),
    linear-gradient(135deg, #f09199, #f6b7b5);
  box-shadow:
    0 0 0 1px rgba(255,255,255,0.3),
    0 8px 18px rgba(0,0,0,0.6);
  transition: transform 0.12s ease, box-shadow 0.12s ease;
}
.trk-main-btn:hover {
  transform: translateY(-1px) scale(1.02);
  box-shadow:
    0 0 0 1px rgba(255,255,255,0.4),
    0 10px 22px rgba(0,0,0,0.7);
}
.trk-main-btn:active {
  transform: translateY(1px) scale(0.97);
  box-shadow:
    0 0 0 1px rgba(255,255,255,0.2),
    0 4px 12px rgba(0,0,0,0.6);
}

.trk-mode-buttons {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  flex: 1;
}
.trk-mode-btn {
  border-radius: 999px;
  padding: 6px 10px;
  font-size: 11px;
  line-height: 1.3;
  cursor: pointer;
  white-space: nowrap;
  backdrop-filter: blur(10px);
  transition: background 0.12s ease, border-color 0.12s ease, color 0.12s ease;
  background: rgba(30, 30, 45, 0.55);  /* 夜空系・濃紺寄りの半透明 */
  border: 1px solid rgba(180, 180, 220, 0.25); /* 星の光っぽい淡いブルー系 */
  color: #dfe7ff; /* 淡い星光ブルー */
}
/* Hover：星がふっと明るくなる */
.trk-mode-btn:hover {
  background: rgba(45, 45, 70, 0.7);
  border-color: rgba(220, 220, 255, 0.45);
  color: #ffffff;
}

.trk-mode-btn.is-active {
  background: linear-gradient(135deg, #F09199, #ffe2c4);
  border-color: rgba(255,255,255,0.7);
  color: #222;
  box-shadow: 0 0 10px rgba(240,145,153,0.45),
              0 0 16px rgba(200,228,255,0.35);
}

/* 楽曲リスト */
.tracks-list {
  margin-top: 6px;
  max-height: 38vh;
  overflow-y: auto;
}

.track-row {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 9px 10px;
  border-radius: 12px;
  margin-bottom: 6px;
  background: rgba(6, 8, 14, 0.8);
  border: 1px solid rgba(255,255,255,0.06);
  transition: background 0.12s ease, border-color 0.12s ease, transform 0.08s ease;
}
.track-row.is-active {
  background:
    linear-gradient(135deg, rgba(240,145,153,0.26), rgba(255,255,255,0.04));
  border-color: rgba(240,145,153,0.9);
}

.track-play-btn {
  flex: 0 0 32px;
  height: 32px;
  border-radius: 999px;
  border: none;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  line-height: 1;
  color: #fff;
  background: radial-gradient(circle at 30% 0%, #fff 0, transparent 55%),
              linear-gradient(135deg, #f09199, #f6b7b5);
  box-shadow: 0 0 0 1px rgba(255,255,255,0.4);
  transition: transform 0.08s ease, box-shadow 0.08s ease, filter 0.08s ease;
}
.track-play-btn.is-playing {
  transform: scale(1.05);
  box-shadow: 0 0 0 2px rgba(255,255,255,0.6);
  filter: brightness(1.12);
}

.track-info {
  flex: 1;
  min-width: 0;
}
.track-title {
  font-size: 13px;
  font-weight: 600;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.track-meta {
  font-size: 11px;
  opacity: 0.75;
  margin-top: 1px;
}

/* Musicsデザイン用↑↑↑ここまで */

/* NFTリンク専用スタイル */
#nft-link {
  display: inline-block;
  padding: 6px 10px;
  border-radius: 8px;
  background: rgba(240,145,153,0.12); /* ピンク寄りの透過背景 */
  color: #F09199;                     /* 桜ピンク文字 */
  font-weight: 600;
  text-decoration: none;
  transition: all 0.25s ease;
  box-shadow: 0 0 6px rgba(240,145,153,0.25);
}
#nft-link:hover {
  background: rgba(240,145,153,0.25);
  color: #fff;
  box-shadow: 0 0 10px rgba(240,145,153,0.5);
}
#nft-link:active {
  transform: scale(0.96);
}


/* タイトル画面のアイコンボタン（Settings / About / Musics / NFT）↑↑↑ここまで */

/* ===== Quick Actions 「ポイント購入」「機種変更」「お問い合わせ」in Title =====↓↓↓ここから */
.quick-actions{
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
  margin: 10px 0 6px;
}

.qa-btn{
  height: 56px;
  border-radius: 14px;
  font-weight: 700;
  font-size: 13px;
  color: #fff;
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.18);
  box-shadow: 0 4px 14px rgba(0,0,0,.25), 0 0 10px rgba(240,145,153,.25) inset;
  backdrop-filter: blur(6px);
  transition: transform .06s ease, filter .15s ease, background .15s ease, border-color .15s ease;
}
.qa-btn:hover{ filter: brightness(1.08); background: rgba(255,255,255,.1); border-color:#F09199; }
.qa-btn:active{ transform: translateY(1px); }

/* モーダルの見た目は既存 .modal/.modal-card が適用されます */
.modal-title{ font-size:18px; font-weight:800; margin:0 0 8px; }
.modal-body{ font-size:14px; opacity:.9; line-height:1.6; }

/* ── お問い合わせ(QAモーダル)のメールリンクを可愛く ──　↓↓↓ここから */
#qa-modal .modal-card a[href^="mailto:"]{
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  border-radius: 9999px;                    /* ぷっくりピル形 */
  background: rgba(240,145,153,.16);       /* ピンク系の半透明 */
  border: 1px solid rgba(240,145,153,.55); /* ふちどり */
  color: #fff;
  text-decoration: none;                    /* 下線なし */
  font-weight: 700;
  box-shadow: 0 3px 12px rgba(0,0,0,.28),
              0 0 12px rgba(240,145,153,.35);
  transition: background .15s ease, border-color .15s ease, transform .05s ease, box-shadow .15s ease;
}

/* ホバー＆アクティブ */
#qa-modal .modal-card a[href^="mailto:"]:hover{
  background: rgba(240,145,153,.26);
  border-color: #F09199;
  box-shadow: 0 4px 14px rgba(0,0,0,.34),
              0 0 18px rgba(240,145,153,.55);
}
#qa-modal .modal-card a[href^="mailto:"]:active{
  transform: translateY(1px);
}

/* アイコンときらめき（控えめ） */
#qa-modal .modal-card a[href^="mailto:"]::before{
  content: "✉";
  font-size: 14px;
}
#qa-modal .modal-card a[href^="mailto:"]::after{
  content: "✨";
  font-size: 12px;
  opacity: .9;
}
/* ── お問い合わせ(QAモーダル)のメールリンクを可愛く ──　↑↑↑ここまで */


/* ===== Quick Actions 「ポイント購入」「機種変更」「お問い合わせ」in Title =====↑↑↑ここまで */

/* ==== Title Footer Deco ====↓↓↓ここから */
.title-footer-deco {
  position: relative;
  width: 100%;
  height: 420px; /* ← 280px → 420px に伸ばす。必要に応じて増減 */
  overflow: hidden;
  pointer-events: none;
}

.title-footer-deco span {
  position: absolute;
  bottom: 0px;
  font-size: 14px;
  opacity: 0.85;
  animation: floatUp linear forwards;
  text-shadow: 0 0 6px rgba(255,255,255,0.4);
}

/* タイトル背景の追加エフェクト */
.title-bg::before {
  content:"";
  position:absolute;
  inset:0;
  background: radial-gradient(400px 200px at 50% 120%, rgba(240,145,153,0.2), transparent 70%);
  filter: blur(40px);
  mix-blend-mode: screen;
}
.title-bg::after {
  content:"";
  position:absolute;
  inset:0;
  /* 上部は透明に近く、下半分が黒に近づく */
  background: linear-gradient(
    180deg,
    rgba(0,0,0,.0) 0%,
    rgba(0,0,0,.25) 40%,
    rgba(0,0,0,.6) 100%
  );
  pointer-events: none;
}

@keyframes floatUp {
  0%   { transform: translateY(0) scale(1); opacity: 0; }
  10%  { opacity: 1; }
  100% { transform: translateY(-270px) scale(1.2); opacity: 0; } /* ← ここを伸ばす */
}

/* ==== Title Footer Deco ====↑↑↑ここまで */

.row{display:flex;gap:10px}
.hidden{display:none !important}
.card{background:#1a1a1a;border:1px solid #2c2c2c;border-radius:14px;padding:12px}
.subtitle{opacity:.7;font-size:12px}
.version{margin-top:1rem;opacity:.7;font-size:12px;color:#F09199}
.scene{position:relative;flex:1;min-height:100vh;border-radius:0;overflow:hidden;background:#000;border:none}
.bg{position:absolute;inset:0;background:#333 center/cover no-repeat;transition:opacity .1s}
.char{
  /*PC向け：立ち絵の調整*/
  position:absolute;
  inset:auto 0 200px 0;  /* PC向け：下からの距離を調整 */
  width:100%;
  display:flex;
  justify-content:center
}
.char img{max-width:50%;max-height:70vh;filter:drop-shadow(0 8px 16px rgba(0,0,0,.6))}

.textbox {
  position: fixed;
  left: 50%;
  bottom: 20px;
  transform: translateX(-50%);
  z-index: 3;

  width: 80%;
  max-width: 800px;
  min-width: 600px;

  /* 背景：黒～濃いグレーのグラデーション */
  background: linear-gradient(180deg, #2a2a2a 0%, #1a1a1a 100%);
  border: 2px solid #F09199; 
  color: #fff;

  /* ピンクの枠をアクセントに */
  border: 2px solid #F09199;
  border-radius: 16px;

  /* 余白と文字調整 */
  padding: 24px 32px 60px 32px;  /* PC向け：余白を大きく */
  font-size: 18px;
  line-height: 1.6;

  /* 影でカード感を演出 */
  box-shadow: 0 6px 20px rgba(0,0,0,0.4),
              0 0 12px rgba(240,145,153,0.6); /* ピンクの外側光 */

}

/* 話者名と本文。本文は既定で4行ぶんの高さを確保（文字サイズに連動） */
.name{ font-weight:700; margin:0 0 6px; }
.name .kana{ font-weight:500; opacity:.9; margin-left:6px; font-size:.9em; }

/* 振り仮名の汎用表示（会話外でも使える版） */
.kana{
  font-weight: 500;
  opacity: .9;
  margin-left: 6px;
  font-size: .7em;
}

.text{
  line-height: 1.6;
  min-height: 4lh;     /* ←標準4行表示。フォントサイズに追従して伸縮 */
  margin: 0 0 8px 0;   /* ボタンとの間に薄い余白 */
}

/* 左上のホームボタン（ストーリー画面のみ） */
.home-btn{
  position:absolute;
  top:8px; left:8px;
  z-index:4;
  width:36px; height:36px;
  border-radius:10px;
  border:1px solid #2c2c2c;
  background:#161616;
  color:#fff;
  font-weight:700;
  box-shadow: 0 2px 10px rgba(0,0,0,.3);
}
.home-btn:hover{ filter: brightness(1.08); }

/* 右上のメニューボタン↓↓↓ここから */
.menu-btn{
  position:fixed; top:20px; right:20px; z-index:4;
  width:48px; height:48px; border-radius:12px;
  border:2px solid #2c2c2c; background:#161616; color:#fff; font-weight:700;
  font-size:20px;
  box-shadow: 0 2px 10px rgba(0,0,0,.3);
  cursor: pointer;
}
.menu-btn:hover{ filter:brightness(1.08); }

/* AUTOの簡易ON表示 */
#btn-auto.active{ outline:2px solid #F09199; }
/* 右上のメニューボタン↑↑↑ここまで */

/* PC向け：テキストボックス左下の小さな戻るボタン↓↓↓ここから */
/* テキストボックス左下の小さな戻るボタン（◀️）だけに適用 */
.textbox > .btn-mini{
  position:absolute;
  left:20px; bottom:20px;
  padding:10px 14px;
  font-size:14px;
  border-radius:10px;
  background:#2a2a2a;
  color:#fff;
  border:2px solid #444;
  opacity:.95;
  cursor: pointer;
}
.textbox > .btn-mini:hover{ filter:brightness(1.08); }
.textbox > .btn-mini[disabled]{ opacity:.45; pointer-events:none; }
/* 戻るボタン（◀️）を無効時は非表示に */
.textbox > .btn-mini[disabled] {
  display: none !important;
}
/* PC向け：テキストボックス左下の小さな戻るボタン↑↑↑ここまで */

/* ==== Choice: アクティブ強調（ハート&光彩） ====↓↓↓ここから */
.choice .btn{
  white-space: normal;  /* 選択肢ボタンが長文になっても折り返して収まる */
  position: relative;
  transition: transform .06s ease, box-shadow .2s ease, background .2s ease;
}
.choice .btn:focus-visible{
  outline: 3px solid rgba(240,145,153,.65);
  outline-offset: 2px;
}

.btn.active { outline:2px solid #F09199; }

/* いま選んでいるものを“ふわっと浮かす” */
#choices .btn.active{
  background: linear-gradient(180deg, #e59797 0%, #d588cc 100%);
  border: 2px solid #F09199;            /* 既存より太め */
  box-shadow:
    0 0 0 3px rgba(240,145,153,.22),    /* 外側の柔らかい輪郭 */
    0 10px 20px rgba(212, 120, 212, 0.35),
    0 0 16px rgba(240,145,153,.45);     /* ピンクのグロー */
  transform: translateY(-1px);
  color:#2f2d2d;
}

/* 右端できらっと走るハイライト（控えめ） */
#choices .btn.active::after{
  content: "";
  position: absolute; inset: -2px;
  border-radius: inherit;
  background: linear-gradient(95deg, transparent 70%, rgba(255,255,255,.20), transparent 90%);
  pointer-events: none;
}

/* Hover でも軽く主張（PC向け） */
#choices .btn:hover{
  box-shadow: 0 0 0 2px rgba(255,255,255,.06) inset, 0 6px 14px rgba(0,0,0,.25);
}

/* ==== 決定ボタン：有効時は主役級に ==== */
@keyframes pulseGlow {
  0%   { box-shadow: 0 4px 10px rgba(0,0,0,.35), 0 0 10px rgba(240,145,153,.55), 0 0 18px rgba(200,228,255,.35); }
  50%  { box-shadow: 0 6px 16px rgba(0,0,0,.40), 0 0 18px rgba(240,145,153,.85), 0 0 34px rgba(200,228,255,.55); }
  100% { box-shadow: 0 4px 10px rgba(0,0,0,.35), 0 0 10px rgba(240,145,153,.55), 0 0 18px rgba(200,228,255,.35); }
}

/* 有効になったら“ピンクの主役ボタン”へ変身 */
.btn-confirm:not([disabled]){
  background: linear-gradient(180deg, #F7A7B0 0%, #F09199 100%);
  color:#111;
  border-color:#fff;
  animation: pulseGlow 1.6s ease-in-out infinite;
}
.btn-confirm:not([disabled])::after{
  content:"✨";
  margin-left:.4em;
}

/* 無効時はグレー寄りで控えめのまま（既存を活かす） */
/* ==== Choice: アクティブ強調（ハート&光彩） ====↑↑↑ここまで */


/*選択肢直下の「決定」ボタン　↓↓↓ここから*/

/* 選択肢のアクティブ表示 */
#choices .btn.active{
  outline: 2px solid #F09199;
  box-shadow: 0 0 10px rgba(240,145,153,.4);
}

/* PC向け：決定ボタン */
.btn-confirm{
  position: absolute;
  left: 50%;
  bottom: 20px;
  transform: translateX(-50%);
  padding: 12px 0;
  font-size: 18px;
  font-weight: 700;
  background: #1a1a1a;
  color: #fff;
  border: 2px solid #F09199;
  box-shadow:
    0 4px 10px rgba(0,0,0,0.35),
    0 0 10px rgba(240,145,153,0.6),
    0 0 18px rgba(240,145,153,0.4);
  transition: filter .2s ease, transform .1s ease, opacity .2s ease;
  z-index: 5;
  width: 50%;                         /* PC向け：大きく */
  border-radius: 999px;               /* ピル型で可愛く */
  letter-spacing: .05em;
  cursor: pointer;
}
.btn-confirm[disabled]{ opacity:.5; filter:grayscale(.2); }
.btn-confirm:hover:not([disabled]){ filter:brightness(1.08); }
.btn-confirm:active:not([disabled]){ transform:translateX(-50%) scale(.98); }

/* ボタン分の余白を確保（テキストボックスの中身が被らないように） */
#choice-box{ padding-bottom: 64px; position: relative; }

/*選択肢直下の「決定」ボタン　↑↑↑ここまで*/


/* PC向け：⏩▶️➡️の小型ボタン行↓↓↓ここから*/
.textbox .nav-mini{
  position:absolute; right:20px; bottom:20px;
  display:flex; gap:10px;
}
.textbox .nav-mini .btn-mini{
  position:static;     /* ← 絶対配置を解除（はみ出し防止） */
  left:auto; bottom:auto;
  min-width: 80px; padding:10px 12px; font-size:14px;
  border:2px solid #444; background:#2a2a2a; color:#fff;
  border-radius:10px; opacity:.95;
  cursor: pointer;
}
.textbox .nav-mini .btn-mini:active{ transform:scale(.97); }
.textbox .nav-mini .btn-mini:hover{ filter:brightness(1.1); }

/* 選択肢モード中は ⏩▶️ ボタンを完全に非表示 */
.textbox.choice-mode .nav-mini {
  display: none !important;
}
/* ⏩▶️➡️の小型ボタン行↑↑↑ここまで*/

.name{font-weight:700;margin-bottom:6px}
.name .kana{font-weight:600;opacity:.9;margin-left:6px;font-size:.9em}
.text{line-height:1.6;min-height:3lh}
.choice{display:flex;flex-direction:column;gap:8px;margin-top:10px}
.hud{
  position:fixed;
  left:20px;
  right:auto;
  top:20px;
  font-size:14px;
  /* 背景と余白はデバッグボックス(#aff-debug)側で持つ */
  background: transparent;
  padding: 0;
  border-radius: 0;
  white-space: pre-line;
  pointer-events: none;     /* 誤タップ防止（任意） */
}
.pulse{animation:pulse .35s ease}
@keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.15)}100%{transform:scale(1)}}
textarea{width:100%;height:120px;border-radius:10px;border:1px solid #2c2c2c;background:#121212;color:#eee;padding:10px;font-family:ui-monospace,"SFMono-Regular",Menlo,Consolas,monospace;font-size:12px}
.mono{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;font-size:12px;opacity:.75}
.form{display:flex;flex-direction:column;gap:8px}
.form label{font-size:12px;opacity:.9}
.form input{padding:10px;border-radius:10px;border:1px solid #2c2c2c;background:#121212;color:#eee}

/* == Font size presets (text & name only) == */
.text { font-size: 16px; }   /* base */
.name { font-size: 16px; }

.fs-s .text { font-size: 14px; }
.fs-s .name { font-size: 14px; }

.fs-m .text { font-size: 16px; }
.fs-m .name { font-size: 16px; }

.fs-l .text { font-size: 18px; }
.fs-l .name { font-size: 18px; }

.fs-xl .text { font-size: 20px; }
.fs-xl .name { font-size: 20px; }

/* == Theme overrides == */
.theme-light body{ background:#f7f7f7; color:#222 }
.theme-light .card{ background:#ffffff; border-color:#e5e5e5 }
.theme-light .btn{ background:#e9e9e9; color:#111 }
.theme-light .btn-ghost{ background:transparent; border-color:#d0d0d0; color:#111 }
.theme-light .scene{ background:#fafafa; border-color:#e5e5e5 }
.theme-light .bg{ background:#ddd center/cover no-repeat }
.theme-light .textbox{ background:linear-gradient(180deg, rgba(255,255,255,0), rgba(255,255,255,.86)) }
.theme-light .hud{ background:rgba(255,255,255,.6); color:#111 }
.theme-light textarea{ background:#fff; color:#222; border-color:#d0d0d0 }
.theme-light .subtitle{ color:#444; opacity:.9 }

/* modal - About&Legalメニュー ↓↓↓ここから*/
#about-modal .modal-body {
  padding-bottom: 24px; /*About モーダルだけ、閉じるボタンの下に余白（スクロールバー出現対策）*/
}
/* About & Legal：リンクの視認性UP（チップ風）↓↓↓ここから */
#about-modal .modal-card a{
  display: inline-flex;
  flex-direction: row;
  align-items: center;
  gap: 6px;
  padding: 6px 10px;
  margin: 4px 0;
  border-radius: 9999px;                 /* pill 形状 */
  background: rgba(240,145,153,.14);     /* ピンク系の半透明背景 */
  border: 1px solid rgba(240,145,153,.45);
  color: #fff;
  text-decoration: none;                 /* 既定の下線は消す */
  box-shadow: 0 2px 10px rgba(0,0,0,.25);
  transition: background .15s ease, border-color .15s ease, transform .05s ease;
  overflow-wrap: anywhere;               /* 長いURLのはみ出し防止 */
}

/* hover / active / focus */
#about-modal .modal-card a:hover{
  background: rgba(240,145,153,.24);
  border-color: #F09199;
}
#about-modal .modal-card a:active{
  transform: translateY(1px);
}
#about-modal .modal-card a:focus-visible{
  outline: 2px solid #F09199;
  outline-offset: 2px;
}

/* メールは封筒アイコン、外部リンクは↗アイコンを付与 */
#about-modal .modal-card a[href^="mailto:"]::before{
  content: "✉";
  opacity: .9;
}
#about-modal .modal-card a[target="_blank"]::after{
  content: "↗";
  font-size: .9em;
  opacity: .9;
  margin-left: 2px;
}

/* 段落内でラベルとのメリハリを少し強める */
#about-modal .modal-card p > strong{
  opacity: .95;
  margin-right: 6px;
}

#about-modal .modal-body {
  overflow-y: auto;
  max-height: calc(86svh - 90px); /* 上部タイトル + 下部ボタン分 */
  padding-right: 6px;              /* スクロールバー余白 */
}
/* About & Legal：リンクの視認性UP（チップ風） ↑↑↑ここまで*/

.modal{
  position:fixed;
  inset:0;
  padding: 12px;                    /* 端に張り付かない余白 */
  background:rgba(0,0,0,.5);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:999;
}

/* 汎用確認モーダルを最前面に↓↓↓ここから */
#sys-confirm {
  z-index: 2000 !important;   /* 既存モーダル(999)より前面へ */
}

/* その内側カードも確実に前面へ */
#sys-confirm .modal-card {
  position: relative;
  z-index: 2001;
}
/* 汎用確認モーダルを最前面に↑↑↑ここまで */

/* 汎用確認モーダル内の改行を有効に↓↓↓ここから */
#sys-confirm-message {
  white-space: pre-line;
}
/* 汎用確認モーダル内の改行を有効に↑↑↑ここまで */

.modal-card{
  /* PC向け：画面幅とアプリ幅の小さい方に収める */
  width: min(90vw, 800px);
  max-width: 800px;
  box-sizing: border-box;

  max-height: 90vh;                /* PC向け：画面高に収める */
  overflow: hidden;                 /* 中は下でスクロール */

  background:#1a1a1a;
  border:1px solid #2c2c2c;
  border-radius:16px;
  padding:24px;

  word-break: break-word;           /* 長文でのハミ出し防止 */
}

/* 中身はスクロール（既に個別指定がある所はそのままでOK） */
.modal-card > .list,
.modal-card > .form,
.modal-card > div[id$="-list"],
#status-body { 
  overflow-y: auto;
  max-height: calc(86svh - 90px);  /* タイトルやボタン分を差し引く */
}
/* “横に2つ以上並ぶ行”でボタンがハミ出さないように */
.row{ display:flex; gap:10px; flex-wrap: wrap; }
.row .btn{ width:auto; flex:1 1 0; }   /* ボタンは可変幅に */

.theme-light .modal-card{background:#fff;border-color:#e5e5e5;color:#111}
/* modal - About&Legalメニュー ↑↑↑ここまで*/

.modal.hidden{display:none}

/* Save / Load / Status のモーダルを画面内に収める */
#status-modal .modal-card,
#save-modal .modal-card,
#load-modal .modal-card,
#tracks-modal .modal-card {
  max-height: 96svh;     /* 画面の8割までに制限したいなら80vh */
  overflow: hidden;     /* 中身はスクロールで処理 */
  display: flex;
  flex-direction: column;
}

#status-body,
#save-list,
#load-list,
#tracks-list {
  flex: 1;
  overflow-y: auto;     /* 中身が溢れたら縦スクロール */
  padding-right: 6px;   /* スクロールバーと文字の余白 */
  max-height: calc(92svh - 90px);  /* 本文エリアも同じ基準に合わせる */
}

/* Load の空スロットを無効表示にする↓↓↓ここから */
.list-item.slot-empty {
  opacity: 0.4;
  cursor: default;
  pointer-events: none; /* クリック不可 */
}
.list-item.slot-empty .meta {
  color: #777;
}
/* Load の空スロットを無効表示にする↑↑↑ここまで */

/* === Heart Meter (Status/HT) ===↓↓↓ここから */
.ht-wrap{ position: relative; }
.ht-hearts{
  font-size: 18px;
  letter-spacing: 2px;
  margin: 2px 0 8px;
}
.ht-hearts .filled{ 
  color: var(--pink);
  text-shadow: 0 0 8px rgba(240,145,153,.5);
}
.ht-hearts .empty{ color:#444; opacity:.6; }

.ht-bar{
  position: relative;
  height: 10px;
  border-radius: 999px;
  background: #2b2b2d;
  border: 1px solid #3a3a3d;
  overflow: hidden;
  box-shadow: inset 0 1px 2px rgba(0,0,0,.6);
}
.ht-bar .fill{
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, #F7A7B0, #F09199 55%, #C8E4FF);
  box-shadow: 0 0 12px rgba(240,145,153,.6);
  transition: width .45s ease;
}
.ht-bar .label{
  position: absolute;
  right: 6px;
  top: -18px;
  font-size: 11px;
  opacity: .85;
}

/* MAX演出 */
.ht-wrap.max .ht-hearts .filled{
  animation: heart-bling 1.8s ease-in-out infinite;
}
.ht-wrap.max::after{
  content: "✨MAX";
  position: absolute;
  right: 6px;
  top: -16px;
  font-size: 11px;
  padding: 2px 6px;
  border-radius: 999px;
  background: linear-gradient(180deg,#ffdbe3,#ffb3c1);
  color:#111;
  border: 1px solid #fff;
  box-shadow: 0 0 10px rgba(240,145,153,.65);
}
@keyframes heart-bling{
  0%,100%{ text-shadow: 0 0 6px rgba(240,145,153,.5); transform: translateY(0) }
  50%{    text-shadow: 0 0 14px rgba(240,145,153,.85); transform: translateY(-0.5px) }
}
/* === Heart Meter (Status/HT) ===↑↑↑ここまで */

/* ▼ Save/Load 削除ボタン専用（小さめ）↓↓↓ここから */
.btn-del {
  font-size: 12px;
  padding: 2px 6px;
  line-height: 1.2;
  background: none;
  border: 1px solid #888;
  color: #888;
  border-radius: 4px;
  cursor: pointer;
}
.btn-del:hover {
  background: #fdd;
  border-color: #c44;
  color: #c00;
}
/* ▼ Save/Load 削除ボタン専用（小さめ）↑↑↑ここまで */

/* ページャ（中央にページ番号） */
.pager{
  display:flex; align-items:center; gap:10px;
  margin-top:12px;
}
.pager .spacer{ flex:1; text-align:center; opacity:.8; }



/* list */
.list{display:flex;flex-direction:column;gap:8px;margin-top:8px}
.list-item{display:flex;flex-direction:column;gap:2px;padding:10px;border-radius:10px;border:1px solid #2c2c2c;background:#161616}
.theme-light .list-item{background:#fafafa;border-color:#e5e5e5}
.list-item .meta{font-size:12px;opacity:.8}

/*メインメニューモーダルのタイトルボタン下部に余白（スクロールバー出現対策）↓↓↓ここから*/
#mainmenu-modal #mnu-title {
  margin-bottom: 12px;   /* 好きな値に調整（8〜12pxくらい） */
}
/*メインメニューモーダルのタイトルボタン下部に余白（スクロールバー出現対策）↑↑↑ここまで*/

/* 次へボタン↓↓↓ここから：右下横長＋ピンク枠＆グロー */
#btn-next {
  position: absolute;
  right: 2px;
  bottom: 2px;
  width: 60%;
  padding: 12px 0;
  border-radius: 12px;
  font-size: 15px;
  font-weight: 700;
  background: #1a1a1a;        /* 濃いグレー背景 */
  color: #fff;
  border: 2px solid #F09199;  /* ピンク枠 */
  /* 常時ほんのり光る */
  box-shadow: 
    0 4px 10px rgba(0,0,0,0.35),
    0 0 10px rgba(240,145,153,0.6),
    0 0 18px rgba(240,145,153,0.4);
  transition: all 0.2s ease;
}
/* PC用 hover（強い光） */
#btn-next:hover {
  background: #2a2a2a;
  filter: brightness(1.08);
  box-shadow: 
    0 6px 14px rgba(0,0,0,0.4),
    0 0 16px rgba(240,145,153,0.9),
    0 0 28px rgba(240,145,153,0.7);
}
/* スマホ用 active（タップした瞬間の押し込み感） */
#btn-next:active {
  transform: scale(0.97); /* 少し縮む */
  box-shadow: 
    0 3px 8px rgba(0,0,0,0.4),
    0 0 14px rgba(240,145,153,0.9),
    0 0 24px rgba(240,145,153,0.6);
}
/* 次へボタン↑↑↑ここまで */

/* 選択肢を縦に並べる↓↓↓ここから */
.choice {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-top: 8px;
}
/* PC向け：選択肢表示時のテキストボックス調整 */
.textbox.choice-mode {
  padding-top: 20px;
  padding-bottom: 80px;  /* PC向け：下マージンを大きめに確保 */
  max-height: 60vh;       /* PC向け：画面の60%くらいに制限 */
  overflow-y: auto;      /* ← 溢れたらスクロール */
}
/* 選択肢を縦に並べる↑↑↑ここまで */

/* ==== Result UI ====↓↓↓ここから */
.result-title{
  font-weight: 900;
  font-size: 18px;
  letter-spacing: .04em;
  margin-bottom: 6px;
}
.result-title::before{ content:"♡"; margin-right:.25em; color: var(--pink); }

.result-text{
  opacity:.9;
  line-height:1.7;
}

.result-label{
  font-weight:800;
  margin-bottom:6px;
}
.result-label::before{ content:"♡"; margin-right:.25em; color: var(--pink); }

.result-target{
  font-size:16px;
  font-weight:700;
}

.result-aff{
  white-space:pre-line; /* 改行で縦並び */
  line-height:1.6;
}
/* ==== Result UI ====↑↑↑ここまで */

/* タイトル画面に3枚の画像をランダム表示↓↓↓ここから */
/* PC向け：タイトル背景レイヤー */
#page-title { 
  position: relative; 
  overflow: hidden; 
  min-height: 100vh;
  display: flex; 
  align-items: center; 
  justify-content: center;
  width: 100%;
}


/* タイトル前景（ボタンやロゴ）を常に前面に */
/* 修正：phone-viewport直下の全要素を前面に */
.phone-viewport > *:not(.title-bg) { position: relative; z-index: 1; }
.title-bg { z-index: 0; }
/* 半透明の暗幕で文字を読みやすくしたい時は擬似要素で */
.title-bg::after{
  content:""; position:absolute; inset:0;
  background: linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,.55));
}
/* タイトル画面に3枚の画像をランダム表示↑↑↑ここまで */



/* ===♥デバッグ用好感度表示♥ Heart colors (per character) ===↓↓↓ここから */
:root{
  --heart-haruto: #FFA24C;    /* オレンジ */
  --heart-tsukasa: #8B1E3F;   /* ワインレッド */
}

/* 既存の .ht-hearts .filled を上書き（より詳細セレクタで） */
.ht-hearts.haruto .filled{
  color: var(--heart-haruto);
  text-shadow: 0 0 2px #fff, 0 0 10px currentColor; /* 白ハイライト + 色グロー */
}
.ht-hearts.tsukasa .filled{
  color: var(--heart-tsukasa);
  text-shadow: 0 0 2px #fff, 0 0 10px currentColor;
}

/* デバッグ表示はミニサイズで */

/* 💖デバッグ表示位置と行間をコンパクトに調整 */
/* PC向け：デバッグ表示 */
#aff-debug {
  position: fixed;
  top: 20px;          /* PC向け：上の余白 */
  left: 20px;
  background: rgba(0,0,0,0.5);
  padding: 12px 16px;  /* PC向け：内側の余白を増やす */
  border-radius: 10px;
  font-size: 14px;
  line-height: 1.2;
  width: 200px;         /* PC向け：幅を広げる */
  max-width: none;
}
#aff-debug .dbg-title{
  white-space: nowrap;  /* ← タイトル行を折り返さない */
}
#aff-debug .ht-hearts{
  font-size: 13px;
  letter-spacing: 2px;
  margin: 0;       /* ← 下の余白を最小限に */
}
#aff-debug .ht-bar{ height: 6px; }
#aff-debug .ht-bar .label{ top:-16px; font-size:10px; }
#aff-debug .row {
  display: flex;
  align-items: center;
  gap: 0px;
  margin-bottom: 1px; /* ← 縦の余白を詰める */
}
#aff-debug .who {
  min-width: 28px;
  font-weight:bold;
  color:#ffe4e1;
  text-shadow:1px 1px 0 #2f4f4f, -1px -1px 0 #2f4f4f,
              -1px 1px 0 #2f4f4f, 1px -1px 0 #2f4f4f,
              0px 1px 0 #2f4f4f,  0-1px 0 #2f4f4f,
              -1px 0 0 #2f4f4f, 1px 0 0 #2f4f4f;
  margin-bottom: 0;        /* ← 名前とハートの間の余白を消す */              
}
#aff-debug .ht-wrap { flex: 1; }

#aff-debug .ht-bar{
  position: relative;
  height: 10px;
  border-radius: 999px;
  background: #2b2b2d;
  border: 1px solid #3a3a3d;
  overflow: hidden;
  box-shadow: inset 0 1px 2px rgba(0,0,0,.6);
}
#aff-debug .ht-bar .fill{
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, #F7A7B0, #F09199 55%, #C8E4FF); /* 共通色 */
  box-shadow: 0 0 12px rgba(240,145,153,.6);
  transition: width .45s ease;
}

/* === デバッグ欄の♥もステータス画面と同色に統一 ↓↓↓ここから=== */
#aff-debug .ht-hearts.haruto .filled {
  color: #F5A623;
  text-shadow: 0 0 4px rgba(245,166,35,0.6);
}
#aff-debug .ht-hearts.koh .filled {
  color: #D27BFF;
  text-shadow: 0 0 4px rgba(210,123,255,0.6);
}
#aff-debug .ht-hearts.ryoya .filled {
  color: #69C9FF;
  text-shadow: 0 0 4px rgba(105,201,255,0.6);
}
#aff-debug .ht-hearts.rei .filled {
  color: #4DD4A5;
  text-shadow: 0 0 4px rgba(77,212,165,0.6);
}
#aff-debug .ht-hearts.tsukasa .filled {
  color: #B54A5D;
  text-shadow: 0 0 4px rgba(181,74,93,0.6);
}
/* === デバッグ欄の♥もステータス画面と同色に統一 ↑↑↑ここまで=== */


/* ===♥デバッグ用好感度表示♥ Heart colors (per character) ===↑↑↑ここまで */

/* ===== ステータス画面　キャラ別♥カラー設定 =====↓↓↓ここから */

/* 陽翔（オレンジ：既存色維持） */
.ht-hearts.haruto .filled {
  color: #F5A623;
  text-shadow: 0 0 8px rgba(245,166,35,0.6);
}

/* 煌（ピンク寄りの紫・あざとかわいい系） */
.ht-hearts.koh .filled {
  color: #D27BFF;  /* ラベンダーピンク */
  text-shadow: 0 0 8px rgba(210,123,255,0.6);
}

/* 涼弥（スカイブルー系・さわやか系） */
.ht-hearts.ryoya .filled {
  color: #69C9FF;
  text-shadow: 0 0 8px rgba(105,201,255,0.6);
}

/* 怜（エメラルドグリーン系・落ち着いた系） */
.ht-hearts.rei .filled {
  color: #4DD4A5;
  text-shadow: 0 0 8px rgba(77,212,165,0.6);
}

/* 司（ワインレッド・既存維持） */
.ht-hearts.tsukasa .filled {
  color: #B54A5D;
  text-shadow: 0 0 8px rgba(181,74,93,0.6);
}

/* ===== ステータス画面　キャラ別♥カラー設定 =====↑↑↑ここまで */



